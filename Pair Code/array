use listWithNumbers

pairOf x is
	pair x x 

treeOfDepth d is
	both d
	pairOf newArrayOfDepth dec d

newArrayOfDepth d is 
	pair treeofDepth d d

arrayTree a is first a
arrayDepth a is second a

log x is
	if less x 2 then 0
	else inc log half x

newArray len is 
	newArrayOfDepth log len

indexToTreePath n depth is
	reverse alignNumber n depth

treeElementByPath tree path is
	if not path then tree
	treeElementByPath
		if head path first tree second tree
		tail path

setTreeElementByPath tree path x is
	if not path then x
	if head path
	then pair 
		setTreeElementByPath left tree tail path x 
		right tree
	else pair 
		left tree 
		setTreeElementByPath right tree tail path x 

getByIndex a i is
	treeElementByPath 
		arrayTree a
		indexToTreePath n arrayDepth a

setByIndex a i x is
	setTreeElementByPath 
		arrayTree a
		indexToTreePath n arrayDepth a
